<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IBAN Shield - Demo Verifica</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background:#1f2937;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.container {
    width:420px;
    background:white;
    color:#111827;
    padding:30px;
    border-radius:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.4);
}

.logo {
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:20px;
}

.logo img {
    width:45px;
}

.logo h1 {
    margin:0;
    font-size:22px;
}

input {
    width:100%;
    padding:12px;
    margin-bottom:12px;
    border-radius:8px;
    border:1px solid #d1d5db;
}

button {
    width:100%;
    padding:12px;
    border:none;
    border-radius:8px;
    background:#2563eb;
    color:white;
    font-weight:bold;
    cursor:pointer;
    margin-top:5px;
}

button:hover {
    background:#1e40af;
}

.result {
    margin-top:15px;
    padding:12px;
    border-radius:8px;
    font-size:14px;
}

.success {
    background:#d1fae5;
    color:#065f46;
}

.warning {
    background:#fef3c7;
    color:#92400e;
}

.error {
    background:#fee2e2;
    color:#991b1b;
}

.score {
    margin-top:8px;
    font-weight:bold;
}
</style>
</head>
<body>

<div class="container">
    <div class="logo">
        <img src="logo.png">
        <h1>IBAN Shield</h1>
    </div>

    <input id="iban" placeholder="Inserisci IBAN">
    <input id="nome" placeholder="Nome intestatario">
    <input id="importo" type="number" placeholder="Importo (â‚¬)">
    <button onclick="verifica()">Verifica Transazione</button>

    <div id="risultato"></div>
    <button id="pdfBtn" style="display:none;" onclick="generaPDF()">ðŸ“„ Genera Certificato</button>
</div>

<script>

const validIBAN = "IT60X0542811101000000123456";
const validName = "mario rossi";

let lastData = null;

function normalize(str){
    return str.toLowerCase().trim();
}

function verifica(){
    const iban = document.getElementById("iban").value.trim();
    const nome = document.getElementById("nome").value;
    const importo = parseFloat(document.getElementById("importo").value);
    const result = document.getElementById("risultato");
    const pdfBtn = document.getElementById("pdfBtn");

    pdfBtn.style.display = "none";
    result.innerHTML = "";

    if(iban !== validIBAN){
        result.innerHTML = "âŒ IBAN non valido (demo).";
        result.className = "result error";
        return;
    }

    if(normalize(nome) !== validName){
        result.innerHTML = "âŒ Nome intestatario NON compatibile con IBAN (demo).";
        result.className = "result error";
        return;
    }

    let score = 95;
    let livello = "Basso";

    if(importo > 1000){
        score = 82;
        livello = "Medio";
        result.innerHTML = "âš  Match positivo. Importo elevato â†’ attivazione verifica avanzata (VOP).";
        result.className = "result warning";
    } else {
        result.innerHTML = "âœ” IBAN valido. Nome compatibile. Transazione a basso rischio.";
        result.className = "result success";
    }

    result.innerHTML += `<div class="score">Shield Score: ${score}/100</div>`;

    lastData = {iban,nome,importo,score,livello};
    pdfBtn.style.display = "block";
}

function generaPDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const id = "IS-" + Date.now();

    doc.setFontSize(18);
    doc.text("IBAN Shield - Certificato di Verifica", 20, 20);

    doc.setFontSize(12);
    doc.text("ID Verifica: " + id, 20, 35);
    doc.text("Data: " + new Date().toLocaleString(), 20, 45);
    doc.text("IBAN: " + lastData.iban, 20, 55);
    doc.text("Nome intestatario: " + lastData.nome, 20, 65);
    doc.text("Importo: â‚¬ " + lastData.importo, 20, 75);
    doc.text("Livello rischio: " + lastData.livello, 20, 85);
    doc.text("Shield Score: " + lastData.score + "/100", 20, 95);

    doc.setTextColor(150);
    doc.setFontSize(50);
    doc.text("IBAN SHIELD", 35, 150, {angle:45});

    doc.save("Certificato_IBAN_Shield.pdf");
}

</script>

</body>
</html>
