<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IBAN Shield - Demo</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:linear-gradient(135deg,#1f2937,#111827);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.container{
    width:420px;
    background:white;
    padding:35px;
    border-radius:20px;
    box-shadow:0 15px 40px rgba(0,0,0,0.35);
}

.logo-wrapper{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:14px;
    margin-bottom:30px;
}

.logo-img{
    width:60px;
}

.brand-text{
    display:flex;
    flex-direction:column;
    line-height:1;
}

.brand-main{
    font-size:24px;
    font-weight:800;
    color:#111827;
}

.brand-sub{
    font-size:18px;
    font-weight:600;
    color:#2563eb;
}

input{
    width:100%;
    padding:12px;
    margin-bottom:14px;
    border-radius:10px;
    border:1px solid #e5e7eb;
    font-size:14px;
}

button{
    width:100%;
    padding:13px;
    border:none;
    border-radius:10px;
    background:#2563eb;
    color:white;
    font-weight:bold;
    font-size:14px;
    cursor:pointer;
    margin-top:8px;
    transition:0.2s;
}

button:hover{
    background:#1e40af;
}

.result{
    margin-top:18px;
    padding:15px;
    border-radius:12px;
    font-size:14px;
}

.success{
    background:#d1fae5;
    color:#065f46;
}

.warning{
    background:#fef3c7;
    color:#92400e;
}

.error{
    background:#fee2e2;
    color:#991b1b;
}

.score{
    margin-top:8px;
    font-weight:bold;
}

#pdfBtn{
    display:none;
    margin-top:12px;
}

</style>
</head>
<body>

<div class="container">

    <div class="logo-wrapper">
        <img src="logo.png" class="logo-img">
        <div class="brand-text">
            <span class="brand-main">IBAN</span>
            <span class="brand-sub">Shield</span>
        </div>
    </div>

    <input id="iban" placeholder="Inserisci IBAN">
    <input id="nome" placeholder="Nome intestatario">
    <input id="importo" type="number" placeholder="Importo (â‚¬)">
    <button onclick="verifica()">Verifica Transazione</button>

    <div id="risultato"></div>
    <button id="pdfBtn" onclick="generaPDF()">ðŸ“„ Genera Certificato</button>

</div>

<script>

const validIBAN = "IT60X0542811101000000123456";
const validName = "mario rossi";

let lastData = null;

function normalize(str){
    return str.toLowerCase().trim();
}

function verifica(){

    const iban = document.getElementById("iban").value.trim();
    const nome = document.getElementById("nome").value;
    const importo = parseFloat(document.getElementById("importo").value);

    const result = document.getElementById("risultato");
    const pdfBtn = document.getElementById("pdfBtn");

    result.innerHTML = "";
    pdfBtn.style.display = "none";

    if(iban !== validIBAN){
        result.innerHTML = "âŒ IBAN non valido (demo).";
        result.className = "result error";
        return;
    }

    if(normalize(nome) !== validName){
        result.innerHTML = "âŒ Nome intestatario NON compatibile con IBAN (demo).";
        result.className = "result error";
        return;
    }

    let score = 95;
    let livello = "Basso";

    if(importo > 1000){
        score = 82;
        livello = "Medio";
        result.innerHTML = "âš  Match positivo. Importo elevato â†’ attivazione verifica avanzata (VOP).";
        result.className = "result warning";
    } else {
        result.innerHTML = "âœ” IBAN valido. Nome compatibile. Transazione a basso rischio.";
        result.className = "result success";
    }

    result.innerHTML += `<div class="score">Shield Score: ${score}/100</div>`;

    lastData = {iban,nome,importo,score,livello};
    pdfBtn.style.display = "block";
}

function generaPDF(){

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const id = "IS-" + Date.now();
    const now = new Date().toLocaleString();

    const img = new Image();
    img.src = "logo.png";

    img.onload = function(){

        doc.setFillColor(31,41,55);
        doc.rect(0,0,210,40,"F");

        doc.addImage(img,"PNG",20,8,20,20);

        doc.setTextColor(255,255,255);
        doc.setFontSize(20);
        doc.text("IBAN Shield",50,22);

        doc.setFontSize(11);
        doc.text("Verified & Protected",50,30);

        doc.setTextColor(0,0,0);
        doc.setFontSize(16);
        doc.text("Certificato Ufficiale di Verifica",20,60);

        doc.rect(20,70,170,65);

        doc.setFontSize(12);
        doc.text("ID Verifica:",25,85);
        doc.text(id,75,85);

        doc.text("Data:",25,95);
        doc.text(now,75,95);

        doc.text("IBAN:",25,105);
        doc.text(lastData.iban,75,105);

        doc.text("Intestatario:",25,115);
        doc.text(lastData.nome,75,115);

        doc.text("Importo:",25,125);
        doc.text("â‚¬ "+lastData.importo,75,125);

        doc.setFillColor(240,249,255);
        doc.rect(20,145,170,35,"F");

        doc.setFontSize(14);
        doc.text("Shield Score: "+lastData.score+"/100",25,165);

        doc.setFontSize(12);
        doc.text("Livello Rischio: "+lastData.livello,25,175);

        doc.setTextColor(235);
        doc.setFontSize(60);
        doc.text("IBAN SHIELD",30,210,{angle:45});

        doc.setTextColor(120);
        doc.setFontSize(9);
        doc.text("Documento generato automaticamente dal protocollo IBAN Shield v1.0",20,285);

        doc.save("Certificato_IBAN_Shield.pdf");
    }
}

</script>

</body>
</html>
